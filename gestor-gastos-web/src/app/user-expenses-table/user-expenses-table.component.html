<section class="expended-section">
    <div class="block-content-center">
        <strong>Total Expended</strong> <br> {{finalAmount | number: '.2-2'}} €
    </div>
    <div class="block-content-center">
        <strong>Total Expended this month</strong> <br> {{finalAmountMoth | number: '.2-2'}} €
    </div>
</section>
<section class="year-selector">
    <button mat-stroked-button (click)="yearSelect.open()" >{{yearSelected}}</button>
</section>
<mat-form-field>
    <mat-select [(value)]="yearSelected" placeholder="Year" (selectionChange)="selectYear($event.value)" #yearSelect>
        <mat-option *ngFor="let year of years" value="{{year}}">{{ year }}</mat-option>
    </mat-select>
</mat-form-field>
<app-chart-expeneses-months [data]="expensesByMonth" [year]="yearSelected.toString()"></app-chart-expeneses-months>
<!-- TODO Sortable -->
<section class="section-table">
    <table mat-table [dataSource]="expensesDataSource" matSort mdbTableScroll scrollX="true" scrollY="True">
        <ng-container matColumnDef="amount">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{'Amount' | translate}}
            </th>
            <td mat-cell *matCellDef="let expense">
                {{expense.amount | number: '.2-2'}} &euro;
            </td>
        </ng-container>
        <ng-container matColumnDef="vatpercentage">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{'VAT %' | translate}}
            </th>
            <td mat-cell *matCellDef="let expense">
                {{expense.vatpercentage | number: '.2-2'}} &percnt;
            </td>
        </ng-container>
        <ng-container matColumnDef="final_amount">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{'Final Amount' | translate}}
            </th>
            <td mat-cell *matCellDef="let expense">
                {{expense.final_amount | number: '.2-2'}} &euro;
            </td>
        </ng-container>
        <ng-container matColumnDef="dossier">
            <th mat-header-cell *matHeaderCellDef>
                {{'Dossier' | translate}}
            </th>
            <td mat-cell *matCellDef="let expense">
                <a *ngIf="expense.dossier != null" mat-stroked-button [href]="expense.dossier">
                    Open dossier
                </a>
            </td>
        </ng-container>
        <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                {{'Date' | translate}}
            </th>
            <td mat-cell *matCellDef="let expense">
                {{expense.formmatedDate}}
            </td>
        </ng-container>        
        <ng-container matColumnDef="showBtn">
            <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
            <td mat-cell *matCellDef="let expense">
                <a mat-raised-button color="accent" href="/expense/{{expense.id}}"> {{"Details" | translate}} </a>
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="getPageSizeOptions()" showFirstLastButtons>
    </mat-paginator>
</section>